<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Investec Developer Community Builds</title>
  <meta name="description" content="A minimalist gallery of community builds from the Investec Developer Community." />
  <link rel="preconnect" href="https://unavatar.io" />
  <style>
    :root {
      --ink:#000; --ink-70:#2a2a2a; --ink-50:#555; --ink-30:#888;
      --paper:#fff; --canvas:#f6f6f6; --line:#e8e8e8; --platinum:#dcdcdc;
      --accent:#00a3a1; --radius:12px;
      --shadow-sm:0 1px 2px rgba(0,0,0,.04);
      --shadow-md:0 6px 20px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Inter,"Helvetica Neue",Arial;
      color:var(--ink-70);
      background:radial-gradient(1200px 800px at 70% -10%, #fafafa 0%, var(--canvas) 60%, #f2f2f2 100%);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{max-width:1200px;margin:0 auto;padding:28px 20px 80px}

    .top{display:grid;grid-template-columns:1fr auto;align-items:center;gap:16px;margin-bottom:14px}
    h1{font-size:clamp(22px,2.2vw,28px);line-height:1.1;color:var(--ink);margin:0;letter-spacing:-0.02em}
    .subtitle{color:var(--ink-50);margin:4px 0 0 0;font-size:.98rem}

    .cta{
      display:inline-flex;align-items:center;gap:10px;padding:10px 14px;background:var(--ink);color:#fff;
      border-radius:999px;text-decoration:none;font-weight:600;box-shadow:var(--shadow-sm);
      transition:transform .15s ease,box-shadow .2s ease,background .2s ease;white-space:nowrap
    }
    .cta:hover{background:#1a1a1a;transform:translateY(-1px);box-shadow:var(--shadow-md)}

    .controls{display:grid;grid-template-columns:1fr;gap:12px;margin:18px 0 20px}
    @media(min-width:720px){ .controls{grid-template-columns:1.2fr auto auto;align-items:center} }
    .search{position:relative}
    .search input{
      width:100%;padding:12px 42px 12px 14px;border:1px solid var(--line);border-radius:999px;background:var(--paper);
      outline:none;font-size:.98rem;transition:border-color .2s ease,box-shadow .2s ease
    }
    .search input:focus{border-color:var(--platinum);box-shadow:0 0 0 6px rgba(0,0,0,.02)}
    .search .icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:18px;color:var(--ink-30)}
    .sort,.view{display:inline-flex;gap:8px;align-items:center;font-size:.92rem;color:var(--ink-50)}
    select{
      appearance:none;-webkit-appearance:none;padding:10px 32px 10px 12px;border:1px solid var(--line);border-radius:999px;background:
      var(--paper) url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="%23888" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>')
      no-repeat right 10px center/18px;color:var(--ink-70);font-size:.95rem
    }

    .tags{display:flex;flex-wrap:wrap;gap:8px;margin-top:4px}
    .tag{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:var(--paper);font-size:.85rem;cursor:pointer;color:var(--ink-50)}
    .tag:hover{border-color:var(--platinum);color:var(--ink-70)}
    .tag.active{background:#111;color:#fff;border-color:#111}

    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:740px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media(min-width:1140px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}

    .card{background:var(--paper);border:1px solid var(--line);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column;box-shadow:var(--shadow-sm);transition:transform .18s ease, box-shadow .2s ease}
    .card:hover{transform:translateY(-3px);box-shadow:var(--shadow-md)}

    .thumb{position:relative;background:#fafafa;aspect-ratio:16/9;overflow:hidden}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .thumb .pill{position:absolute;left:10px;top:10px;background:rgba(17,17,17,.75);color:#fff;font-size:12px;padding:6px 8px;border-radius:999px;backdrop-filter:blur(4px)}

    .body{padding:14px 14px 0;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:700;color:var(--ink);margin:0;font-size:1.05rem;letter-spacing:-0.01em}
    .title a{color:inherit;text-decoration:none}
    .desc{color:var(--ink-50);line-height:1.6;margin:2px 0 0;font-size:.95rem}

    .meta{display:flex;align-items:center;gap:10px;color:var(--ink-30);font-size:.88rem}
    .avatar{width:26px;height:26px;border-radius:50%;border:1px solid var(--line);object-fit:cover}

    .tagrow{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
    .chip{background:#f2f2f2;border:1px solid var(--line);color:#333;padding:4px 8px;border-radius:999px;font-size:11px}

    .shots{display:flex;gap:8px;overflow:auto;padding:10px 14px 2px}
    .shots img{height:64px;width:auto;border-radius:8px;border:1px solid var(--line);flex:0 0 auto;cursor:pointer}
    .shots img:hover{outline:2px solid #ddd}

    .links{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px 14px 14px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;text-decoration:none;padding:9px 10px;border-radius:10px;border:1px solid var(--line);color:var(--ink-70);background:var(--paper)}
    .btn:hover{border-color:var(--platinum);color:var(--ink);background:#fdfdfd}

    .codeblock{margin:0 14px 14px;background:#0f0f0f;color:#f0f0f0;border-radius:10px;border:1px solid #1a1a1a}
    .codeblock pre{margin:0;padding:12px;overflow:auto;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:12.5px;line-height:1.5}
    .copybar{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-top:1px solid #1a1a1a}
    .copybar small{color:#c8c8c8}
    .copybtn{border:1px solid #303030;background:#161616;color:#fff;border-radius:8px;padding:6px 8px;cursor:pointer}
    .copybtn:hover{background:#1d1d1d}

    .skeleton{background:var(--paper);border:1px solid var(--line);border-radius:var(--radius);overflow:hidden}
    .sk-thumb{background:linear-gradient(90deg,#eee,#f6f6f6,#eee);background-size:200% 100%;animation:shimmer 1.2s infinite;aspect-ratio:16/9}
    .sk-lines{padding:12px}
    .sk-line{height:12px;background:#eee;border-radius:6px;margin:8px 0}
    .sk-line.w60{width:60%}.sk-line.w80{width:80%}.sk-line.w40{width:40%}
    @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}

    footer{margin-top:28px;color:var(--ink-30);font-size:.88rem;text-align:center}
    .toplink{position:fixed;right:16px;bottom:16px;background:var(--ink);color:#fff;border-radius:999px;padding:10px 12px;text-decoration:none;font-size:.9rem;box-shadow:var(--shadow-md)}
    .toplink:hover{background:#111}
    :focus-visible{outline:2px solid var(--accent);outline-offset:2px}
  </style>
</head>
<body>
  <a id="top"></a>
  <div class="wrap">
    <div class="top" role="banner">
      <div>
        <h1>Investec Developer Builds Showcase</h1>
        <p class="subtitle">Showcasing tools, dashboards, automations, and experiments built with Investec APIs - shared by our talented community ü¶ì. Minimal, fast, and built for developers.</p>
      </div>
      <a class="cta" href="https://github.com/Investec-Developer-Community/Community-Projects/issues/new?template=build-submission.yml" target="_blank" rel="noopener"><span style="color:white;"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="white" viewBox="0 0 24 24" style="margin-right:6px">
    <path d="M12 5v14m-7-7h14" stroke="white" stroke-width="2" stroke-linecap="round"/>
  </svg>
  Submit your build
</a>
    </div>

    <section class="controls" aria-label="Filters and search">
      <div class="search">
        <input id="q" type="search" placeholder="Search by title, description, or author‚Ä¶" aria-label="Search builds" />
        <span class="icon">‚åòK</span>
      </div>
      <div class="sort">
        <label for="sort">Sort</label>
        <select id="sort" aria-label="Sort builds">
          <option value="latest">Latest</option>
          <option value="az">A ‚Üí Z</option>
        </select>
      </div>
      <div class="view"><span>Filters</span></div>
      <div class="tags" id="tagbar" aria-label="Tag filters"></div>
    </section>

    <section aria-live="polite" aria-busy="true">
      <div id="grid" class="grid" data-state="loading"></div>
      <p id="empty" style="display:none;text-align:center;color:var(--ink-50);margin:18px 0;"></p>
    </section>

    <section class="disclaimer" style="margin-top:32px;padding:16px;border:1px solid var(--line);border-radius:12px;background:var(--paper);font-size:0.9rem;line-height:1.5;color:var(--ink-50);">
      <strong>üåü Community-Powered Repository üåü</strong><br>
      This gallery is curated with ‚ù§Ô∏è by our talented community members. It‚Äôs a space for everyone to use, contribute to, and share. 
      While it aligns with the spirit of our community, please note that these builds are <strong>not</strong> directly endorsed or supported by Investec. 
      Always exercise caution and discretion when using or contributing to community-driven projects.
    </section>

    <footer>
      <p>Questions or ideas? <a href="https://github.com/orgs/Investec-Developer-Community/discussions" target="_blank" rel="noopener">Discuss feature requests here</a> or <a href="https://github.com/Investec-Developer-Community/.github/issues" target="_blank" rel="noopener">submit an issue/bug here</a>. Be kind. Build boldly.</p>
      <p class="subtitle" style="margin-top:8px;">üí° Looking for more open-source gems? <a href="https://github.com/Investec-Developer-Community/Community-Projects" target="_blank" rel="noopener">Browse the archive</a></p>
    </footer>
  </div>

  <a class="toplink" href="#top" aria-label="Back to top">‚Üë</a>

  <script>
    // ===== helpers =====
    const $ = (s, el=document) => el.querySelector(s);
    const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));
    const debounce = (fn, ms=200) => { let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); }; };

    const PLACEHOLDER_SVG = `
      <svg viewBox="0 0 640 360" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="No Screenshot">
        <defs><linearGradient id="g" x1="0" x2="1" y1="0" y2="1">
          <stop offset="0" stop-color="#efefef"/><stop offset="1" stop-color="#e7e7e7"/></linearGradient></defs>
        <rect width="640" height="360" rx="12" fill="url(#g)"/>
        <g fill="#9e9e9e" transform="translate(320 170)">
          <path d="M-120-30h35l12-18h46l12 18h35a20 20 0 0120 20v70a20 20 0 01-20 20h-140a20 20 0 01-20-20v-70a20 20 0 0120-20zm70 20a40 40 0 100 80 40 40 0 000-80z"/>
        </g>
        <text x="50%" y="70%" dominant-baseline="middle" text-anchor="middle"
              fill="#9e9e9e" font-family="system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial" font-size="28">
          No Screenshot
        </text>
      </svg>`;
    const PLACEHOLDER_URL = `data:image/svg+xml;utf8,${encodeURIComponent(PLACEHOLDER_SVG)}`;

    const fmtDate = (iso) => {
      if (!iso) return '';
      const d = new Date(iso); if (Number.isNaN(d)) return '';
      return d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});
    };

    // Prefer enriched fields from builds.json, otherwise fall back to unavatar
    const avatarUrlFor = (b) => {
      if (b.avatarUrl) return b.avatarUrl;
      const handle = (b.github_username || b.github || b.author || b.submitter || '').toString().replace(/^@/,'').trim();
      return handle ? `https://unavatar.io/github/${encodeURIComponent(handle)}` : `https://unavatar.io/placeholder`;
    };
    const authorLinkFor = (b) => b.authorProfile || (b.submitter ? `https://github.com/${encodeURIComponent(b.submitter)}` : null);

    const asArray = (v) => Array.isArray(v) ? v : (typeof v==='string' ? v.split(',').map(s=>s.trim()).filter(Boolean) : []);
    const escapeHTML = (s) => String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#039;');

    // ===== state =====
    let ALL=[]; let FILTER={ q:'', tags:new Set(), sort:'latest' };

    // ===== skeletons =====
    const renderSkeletons=(n=9)=>{
      const grid=$('#grid'); grid.innerHTML='';
      for(let i=0;i<n;i++){
        const el=document.createElement('div');
        el.className='skeleton';
        el.innerHTML=`<div class="sk-thumb"></div><div class="sk-lines"><div class="sk-line w80"></div><div class="sk-line"></div><div class="sk-line w60"></div></div>`;
        grid.appendChild(el);
      }
    };

    // ===== card =====
    const codeBlock = (text) => {
      const id = 'c' + Math.random().toString(36).slice(2);
      const escaped = escapeHTML(String(text||'').trim());
      return `<div class="codeblock"><pre id="${id}"><code>${escaped}</code></pre>
              <div class="copybar"><small>How to run</small><button class="copybtn" data-copy="${id}">Copy</button></div></div>`;
    };

    const buildCard = (b) => {
      const title = b.projectName || b.title || 'Untitled build';
      const created = fmtDate(b.created_at);
      const shots = asArray(b.screenshots);
      const cover = shots[0] || b.cover || PLACEHOLDER_URL;
      const repo = b.repoLink || b.repo || b.repository;
      const demo = b.liveDemo || b.demo || b.url_demo;
      const bestLink = repo || demo || b.url;
      const authorName = b.author || b.submitter || b.github_username || 'Anonymous';
      const authorHref = authorLinkFor(b);
      const tags = asArray(b.tags || b.categories);

      const card=document.createElement('article');
      card.className='card';
      card.setAttribute('tabindex','0');

      // hero
      const hero=document.createElement('div');
      hero.className='thumb';
      hero.innerHTML=`<img src="${cover}" alt="${title} screenshot" referrerpolicy="no-referrer" onerror="this.src='${PLACEHOLDER_URL}'">
                      ${created?`<span class="pill">${created}</span>`:''}`;
      card.appendChild(hero);

      // body
      const body=document.createElement('div');
      body.className='body';
      body.innerHTML=`
        <h2 class="title">${bestLink?`<a href="${bestLink}" target="_blank" rel="noopener">${title}</a>`:escapeHTML(title)}</h2>
        <p class="desc">${b.description?escapeHTML(b.description):'<em>No description provided.</em>'}</p>
        <div class="meta">
          <img class="avatar" src="${avatarUrlFor(b)}" alt="${authorName} avatar" referrerpolicy="no-referrer" onerror="this.style.display='none'">
          <span>by ${authorHref?`<a href="${authorHref}" target="_blank" rel="noopener" style="color:#333;text-decoration:none">${escapeHTML(authorName)}</a>`:escapeHTML(authorName)}</span>
        </div>
        ${tags.length?`<div class="tagrow">${tags.map(t=>`<span class="chip">${escapeHTML(t)}</span>`).join('')}</div>`:''}
      `;
      card.appendChild(body);

      // thumbs (click to swap main)
      if (shots.length>1){
        const strip=document.createElement('div'); strip.className='shots';
        shots.slice(1,7).forEach((url,i)=>{
          const t=document.createElement('img');
          t.src=url; t.alt=`Screenshot ${i+2}`; t.loading='lazy'; t.referrerPolicy='no-referrer';
          t.onerror=()=>{t.style.display='none';};
          t.addEventListener('click',()=>{ const img=hero.querySelector('img'); img.src=url; });
          strip.appendChild(t);
        });
        card.appendChild(strip);
      }

      // links
      const actions=document.createElement('div'); actions.className='links';
      const links=[
        repo&&{label:'üì¶ Repo',href:repo},
        demo&&{label:'üöÄ Live demo',href:demo},
        {label:'üìù Submission',href:b.url}
      ].filter(Boolean);
      links.forEach(l=>{ const a=document.createElement('a'); a.className='btn'; a.href=l.href; a.target='_blank'; a.rel='noopener'; a.textContent=l.label; actions.appendChild(a); });
      card.appendChild(actions);

      // instructions
      if (b.instructions) card.insertAdjacentHTML('beforeend', codeBlock(b.instructions));
      return card;
    };

    // ===== render =====
    const render=()=>{
      const grid=$('#grid'); grid.setAttribute('aria-busy','true');
      const q=(FILTER.q||'').toLowerCase();

      let list=ALL.filter(b=>{
        const hay=[b.projectName||b.title,b.description,b.author||b.submitter,b.github_username].join(' ').toLowerCase();
        const matchesQ=!q || hay.includes(q);
        const tags=new Set(asArray(b.tags||b.categories).map(t=>String(t).toLowerCase()));
        const active=FILTER.tags;
        const matchesTags = active.size===0 || [...active].every(t=>tags.has(t));
        return matchesQ && matchesTags;
      });

      if (FILTER.sort==='az'){
        list.sort((a,b)=>String(a.projectName||a.title).localeCompare(String(b.projectName||b.title)));
      } else {
        list.sort((a,b)=>new Date(b.created_at||0)-new Date(a.created_at||0)).reverse();
      }

      grid.innerHTML='';
      if (!list.length) {
  const messages = [
    `<strong>‚ö†Ô∏è 404: Builds Not Found</strong><br>The community gallery is waiting for your <code>submission</code>.`,
    `<strong>üõ†Ô∏è This space intentionally left awesome.</strong><br>Got something cool? Push it here ‚Üí <a href="https://github.com/Investec-Developer-Community/Community-Projects/issues/new?template=build-submission.yml" target="_blank" rel="noopener">Submit your build</a>.`,
    `<strong>üíª while(true) { waitForBuilds(); }</strong><br>‚Ä¶Still waiting. Help us break the loop.`
  ];
  const msg = messages[Math.floor(Math.random() * messages.length)];
  const emptyEl = $('#empty');
  emptyEl.innerHTML = msg;
  emptyEl.style.display = 'block';
}
      else { $('#empty').style.display='none'; list.forEach(b=>grid.appendChild(buildCard(b))); }
      grid.removeAttribute('aria-busy');
    };

    // ===== tags =====
    const renderTags=()=>{
      const bar=$('#tagbar'); bar.innerHTML='';
      const set=new Set(); ALL.forEach(b=>asArray(b.tags||b.categories).forEach(t=>set.add(t)));
      const tags=[...set].sort((a,b)=>String(a).localeCompare(String(b)));
      if (!tags.length){ bar.style.display='none'; return; }
      bar.style.display='flex';

      const allBtn=document.createElement('button');
      allBtn.className='tag'+(FILTER.tags.size===0?' active':'');
      allBtn.textContent='All';
      allBtn.addEventListener('click',()=>{ FILTER.tags.clear(); updateURL(); renderTags(); render(); });
      bar.appendChild(allBtn);

      tags.forEach(t=>{
        const key=String(t).toLowerCase();
        const btn=document.createElement('button');
        btn.className='tag'+(FILTER.tags.has(key)?' active':'');
        btn.textContent=t;
        btn.addEventListener('click',()=>{
          if (FILTER.tags.has(key)) FILTER.tags.delete(key); else FILTER.tags.add(key);
          renderTags(); updateURL(); render();
        });
        bar.appendChild(btn);
      });
    };

    // ===== data load =====
    const hydrateFromURL=()=>{
      const p=new URLSearchParams(location.search);
      FILTER.q=p.get('q')||''; FILTER.sort=p.get('sort')||'latest';
      FILTER.tags=new Set((p.get('tags')||'').split(',').map(s=>s.toLowerCase()).filter(Boolean));
      $('#q').value=FILTER.q; $('#sort').value=FILTER.sort;
    };
    const updateURL=()=>{
      const p=new URLSearchParams();
      if (FILTER.q) p.set('q',FILTER.q);
      if (FILTER.sort && FILTER.sort!=='latest') p.set('sort',FILTER.sort);
      if (FILTER.tags.size) p.set('tags',[...FILTER.tags].join(','));
      history.replaceState(null,'',`${location.pathname}?${p.toString()}`);
    };

    const load=async()=>{
      renderSkeletons(9);
      try{
        const res=await fetch('./builds.json',{cache:'no-store'});
        if(!res.ok) throw new Error(`Failed to load builds.json (${res.status})`);
        const data=await res.json();
        ALL=Array.isArray(data)?data:[];
      }catch(e){
        $('#grid').innerHTML=`<div class="card" style="padding:16px">ü¶ì No builds‚Ä¶ yet</div>`;
        return;
      }
      hydrateFromURL(); renderTags(); render();
    };

    // interactions
    const onSearch=debounce(e=>{ FILTER.q=e.target.value.trim(); updateURL(); render(); },200);
    $('#q').addEventListener('input',onSearch);
    document.addEventListener('keydown',e=>{ if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==='k'){ e.preventDefault(); $('#q').focus(); }});
    $('#sort').addEventListener('change',e=>{ FILTER.sort=e.target.value; updateURL(); render(); });
    document.addEventListener('click',e=>{
      const btn=e.target.closest('.copybtn');
      if(!btn) return;
      const pre=document.getElementById(btn.dataset.copy);
      if (!pre) return;
      const txt=pre.innerText;
      navigator.clipboard.writeText(txt).then(()=>{ btn.textContent='Copied'; setTimeout(()=>btn.textContent='Copy',1200); })
                                         .catch(()=>{ btn.textContent='Failed'; setTimeout(()=>btn.textContent='Copy',1200); });
    });

    load();
  </script>
</body>
</html>
